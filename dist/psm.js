const psm=a=>{let b=["addrr","addrv","subrr","subrv","andrr","orrr","xorrr","notr","bv","movrr","movrv","loadrv","storr","stovr","testrr","pass"],c=a=>a.replaceAll(/^\s*[\r\n]+|#.*/gm,"").replaceAll(/:[\n\s]+/g,":").trim(),d=a=>{let b;return a.map(a=>(b=a.match(/^([a-zA-Z_][\w_]*):/))&&b[1])},e=a=>{a=c(a);let b=a.split("\n");return d(b).forEach((b,c)=>{a=a.replaceAll(`$${b}`,c).replaceAll(`${b}:`,"")}),a},f=a=>a.replaceAll(","," ").replaceAll(/\s+/g," ").split(" "),g=a=>a.map(b=>isNaN(parseInt(b))?"r":"v"),h=a=>[...a.matchAll(/("[^"]*"|\d+)/g)].map(a=>JSON.parse(a[0])),i=a=>{let b=f(a),[c,d,e]=b.shift().match(/([abd-y]+)([zc])?/),h=g(b),i=b.filter((b,a)=>"r"==h[a]).map(a=>"abcd".indexOf(a)),j=parseInt(b[h.indexOf("v")]);return{code:d+h.join(""),flag:e,val:j,regs:i}},j=a=>a.map(a=>a.match(/^[a-z]+$|[a-z]+\s(\s*([a-d]|\d+)(,|$))*$/)?i(a):h(a));return(a=>{let c=j(e(a).split("\n"));return new Int32Array(c.map(a=>{if(a.code){let c=b.indexOf(a.code),d="cz".indexOf(a.flag||"c"),e=0+!!a.flag,f=-1<a.regs[0]?a.regs[0]:0,g=-1<a.regs[1]?a.regs[1]:0;a.code.startsWith("sto")&&([f,g]=[g,f]);let h=a.val||0;return h+(g<<21)+(f<<23)+(e<<25)+(d<<26)+(c<<27)}return a.map(a=>"string"==typeof a?a.split("").map(a=>a.charCodeAt(0)):a)}).flat())})(a)};
